(this["webpackJsonpdata-visualization"]=this["webpackJsonpdata-visualization"]||[]).push([[0],{35:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var c=n(15),r=n.n(c),a=n(29),o=n.n(a),s=(n(35),n(18)),i=n.n(s),u=n(14),l=n(17),d=n(20),p=n(8),j=n(16),O="CUSTOM_SCENARIO",b="DOC_OPEN",f="DOC_UPDATE",h="DOC_SYNC",y="DOC_CLOSE",x="INSERT",N="DELETE",v=(n(37),n(0));function T(e){var t=Object(p.a)(e,2),n=t[0],c=t[1];switch(n){case b:return n;case f:var r=c.id;return c.actions.map((function(e){if(e.type===x)return"".concat(n," Doc:").concat(r," type:").concat(e.type," pos:").concat(e.pos," str:").concat(e.str);if(e.type===N)return"".concat(n," Doc:").concat(r," type:").concat(e.type," pos:").concat(e.pos," len:").concat(e.len);throw new Error("Unexpect edit type: "+e.type)})).join(" ; ");case h:return void 0===c.index?"".concat(n," FromDoc:").concat(c.from," ToDoc:").concat(c.to):"".concat(n," FromDoc:").concat(c.from," ToDoc:").concat(c.to," updateIndex:").concat(c.index);case y:return n;default:throw new Error("Expected action: "+n)}}function m(e){var t="scenarios";var n=e.scenarios[e.currentScenario],c=n&&n[e.currentScenarioStepIndex-1],r=n&&n[e.currentScenarioStepIndex];return Object(v.jsxs)("div",{className:"scenarios",children:[Object(v.jsx)("label",{htmlFor:t,children:"Scenarios: "}),Object(v.jsxs)("select",{id:t,onChange:function(t){t.target.value!==e.currentScenario&&e.onScenarioChange(t.target.value)},children:[Object(v.jsx)("option",{value:O,children:"Custom"}),Object.keys(e.scenarios).map((function(e){return Object(v.jsx)("option",{value:e,children:e},e)}))]}),n&&Object(v.jsx)("button",{disabled:e.currentScenario===O,onClick:function(){var t=e.scenarios[e.currentScenario];e.currentScenarioStepIndex<t.length?e.onNextStep():e.onRestartStep()},className:"next-step-button",children:r?"Next step":"Restart"}),r&&Object(v.jsx)("span",{className:"next-step",children:T(r)}),c&&Object(v.jsxs)("p",{className:"current-step",children:[Object(v.jsx)("span",{className:"current-step-label",children:"Current step: "}),Object(v.jsx)("span",{children:T(c)})]})]})}n(39);function C(e){return Object(v.jsxs)("div",{className:"doc-tab",children:[e.editable&&Object(v.jsx)("button",{className:"doc-close",onClick:function(){e.onCloseDoc(e.doc)},children:"x"}),Object(v.jsxs)("p",{className:"doc-id",children:["Doc",e.doc.id]}),Object(v.jsxs)("span",{className:"doc-options",children:[e.doc.yDoc.gc&&Object(v.jsx)("span",{children:"GC\u2714\ufe0f"}),e.doc.pud&&Object(v.jsx)("span",{children:"PermanentUserData\u2714\ufe0f"})]})]})}var g="Text";n(40);function E(e,t,n){var c=function(e,t,n){for(var c=Math.min(Math.max(e.length-1,0),Math.max(t.length-1,0),n),r=0;r<=c;r++)if(e[r]!==t[r])return r;return 0===e.length||0===t.length?0:c+1}(e,t,n),r=function(e,t,n){for(var c=Math.min(Math.max(e.length-1,0),Math.max(t.length-n,0)),r=0;r<=c;r++)if(e[e.length-1-r]!==t[t.length-1-r])return r;return c}(e,t,n);if(c+r>e.length-1||c+r>t.length-1){var a=function(e,t,n){if(e.length>t.length)return{type:N,pos:n,len:e.length-t.length};if(e.length<t.length){var c=n-(t.length-e.length);return{type:x,pos:c,str:t.slice(c,n)}}return null}(e,t,n);return a?[a]:[]}var o={pos:c,len:e.length-r-c},s={pos:c,str:t.slice(c,t.length-r)},i=[];return o.len&&i.push({type:N,pos:o.pos,len:o.len}),s.str.length&&i.push({type:x,pos:s.pos,str:s.str}),i}function D(e){return e.getText(g).toString()}function S(e){var t=Object(c.useRef)(null),n=Object(c.useRef)(D(e.doc.yDoc));return Object(c.useEffect)((function(){var c=D(e.doc.yDoc);t.current.textContent!==c&&(t.current.textContent=c),n.current!==c&&(n.current=c)})),Object(v.jsx)("p",{contentEditable:e.editable?"true":"false",className:"editor ".concat(e.focused?"focused":""),onInput:function(t){var c=t.target.textContent;if(n.current!==c){var r=window.getSelection().getRangeAt(0).startOffset,a=E(n.current,c,r);a.length&&(n.current=c,e.onEditorChange({id:e.doc.id,actions:a}))}},ref:t})}n(41);function _(e){return"".concat(e.type," ").concat(e.pos," ").concat(e.str||e.len)}function k(e){function t(t,n){return function(){e.onSync({from:e.doc.id,to:t,index:n})}}return Object(v.jsx)("div",{className:"updates",children:e.doc.updates.map((function(n,c){return Object(v.jsxs)("p",{className:"update",children:[Object(v.jsx)("span",{className:"update-detail".concat(n.action.type===x?" insert":" delete"),children:_(n.action)}),e.editable&&e.docs.filter((function(e){return e&&!n.syncedIds.includes(e.id)})).map((function(e){return Object(v.jsxs)("button",{className:"sync-button",onClick:t(e.id,c),children:["To Doc",e.id]},e.id)}))]},c+_(n.action))}))})}var I={SHARE:"share",STORE:"store"},A=n(6),w=n(13),Y={DOC:"Doc",ABSTRACT_TYPE:"AbstractType",Y_ARRAY:"YArray",Y_MAP:"YMap",Y_TEXT:"YText",Y_XML_ELEMENT:"YXmlElement",Y_XML_FRAGMENT:"YXmlFragment",Y_XML_TEXT:"YXmlText",ABSTRACT_STRUCT:"AbstractStruct",GC:"GC",ITEM:"Item",SKIP:"Skip",CONTENT_ANY:"ContentAny",CONTENT_BINARY:"ContentBinary",CONTENT_DELETED:"ContentDeleted",CONTENT_DOC:"ContentDoc",CONTENT_EMBED:"ContentEmbed",CONTENT_FORMAT:"ContentFormat",CONTENT_JSON:"ContentJSON",CONTENT_STRING:"ContentString",CONTENT_TYPE:"ContentType"},R=n(3),M=n(1),B=n(4),F=n(12),L=[function(){return new j.Array},function(){return new j.Map},function(){return new j.Text},function(e){M.k(e)},function(e){},function(e){M.k(e)},function(e){}];var X=[function(){throw F.c()},function(e){return{type:Y.CONTENT_DELETED,length:M.l(e)}},function(e){for(var t=M.l(e),n=[],c=0;c<t;c++){var r=M.k(e);"undefined"===r?n.push(void 0):n.push(JSON.parse(r))}return{type:Y.CONTENT_JSON,content:n,length:t}},function(e){var t=M.m(e);return{type:Y.CONTENT_BINARY,content:t,length:1}},function(e){var t=M.k(e);return{type:Y.CONTENT_STRING,string:t,length:t.length}},function(e){var t=M.k(e);return{type:Y.CONTENT_EMBED,content:t,length:1}},function(e){var t=M.k(e),n=M.k(e);return{type:Y.CONTENT_FORMAT,content:{key:t,value:n},length:1}},function(e){var t=L[M.l(e)](e);return{type:Y.CONTENT_TYPE,content:t,length:1}},function(e){for(var t=M.l(e),n=[],c=0;c<t;c++){var r=M.h(e);n.push(r)}return{type:Y.CONTENT_ANY,content:n,length:t}}];function U(e){e instanceof M.a||(e=M.f(e));for(var t={clients:{}},n=M.l(e),c=0;c<n;c++){var r=M.l(e),a=M.l(e);if(a>0){t.clients[r]=[];for(var o=0;o<a;o++)t.clients[r].push({clock:M.l(e),length:M.l(e)})}}return t}function P(e){return function(e){var t=function(e){for(var t={},n=M.l(e),c=0;c<n;c++){for(var r=M.l(e),a=[],o=G(e),s=o.clock,i=o.client,u=0;u<r;u++){var l=M.i(e),d=void 0,p=B.i&l;d=0===p?new H(Y.GC,i,s,{length:M.l(e)}):10===p?new H(Y.SKIP,i,s,{length:M.l(e)}):K(i,s,e,l),a.push(d),s+=d.length}t[i]=a}return t}(e),n=U(e);return{clientsStructs:t,deleteSet:n}}(M.f(e))}function G(e){return{client:M.l(e),clock:M.l(e)}}var J,H=function e(t,n,c,r,a,o,s,i,u,l){var d=this;Object(R.a)(this,e),this.type=t,this.client=n,this.clock=c,this.left=a,this.origin=o,this.right=s,this.rightOrigin=i,this.parentYKey=u,this.parent=l,Object.keys(r).forEach((function(e){d[e]=r[e]}))};function K(e,t,n,c){var r=(c&B.g)===B.g?G(n):null,a=(c&B.f)===B.f?G(n):null,o=0===(c&(B.f|B.g)),s=!!o&&1===M.l(n),i=o&&s?M.k(n):null,u=null;o&&!s&&(u=G(n)),o&&(c&B.e)===B.e&&M.k(n);var l=function(e,t){return X[t&B.i](e)}(n,c);return new H(Y.ITEM,e,t,l,null,r,null,a,i,u)}function W(e,t){var n,c={},r=Object(w.a)(e._map);try{for(r.s();!(n=r.n()).done;){var a=Object(p.a)(n.value,2),o=a[0],s=a[1];c[o]=q(s,t)}}catch(i){r.e(i)}finally{r.f()}return c}function z(e,t){for(var n=[],c=e._start;null!==c;)n.push(q(c,t)),c=c.right;return n}var V=(J={},Object(A.a)(J,Y.DOC,(function(e,t){var n,c={share:{},store:{clients:{},pendingDs:e.store.pendingDs,pendingStructs:{missing:Object.fromEntries(e.store.pendingStructs.missing.entries()),update:P(e.store.pendingStructs.update)}}},r=Object(w.a)(e.share);try{for(r.s();!(n=r.n()).done;){var a=Object(p.a)(n.value,2),o=a[0],s=a[1];c.share[o]=q(s,t)}}catch(O){r.e(O)}finally{r.f()}var i,u=Object(w.a)(e.store.clients);try{for(u.s();!(i=u.n()).done;){var l=Object(p.a)(i.value,2),d=l[0],j=l[1];c.store.clients[d]=j.map((function(e){return q(e,t)}))}}catch(O){u.e(O)}finally{u.f()}return c})),Object(A.a)(J,Y.Y_ARRAY,(function(e,t){return{array:z(e,t)}})),Object(A.a)(J,Y.Y_MAP,(function(e,t){return{map:W(e,t)}})),Object(A.a)(J,Y.Y_TEXT,(function(e,t){return{text:z(e,t)}})),Object(A.a)(J,Y.Y_XML_ELEMENT,(function(e,t){return{nodeName:e.nodeName,attributes:W(e,t),children:z(e,t)}})),Object(A.a)(J,Y.Y_XML_FRAGMENT,(function(e,t){return{children:z(e,t)}})),Object(A.a)(J,Y.Y_XML_TEXT,(function(e,t){return{xmlText:z(e,t)}})),Object(A.a)(J,Y.GC,(function(e){return{client:e.id.client,clock:e.id.clock,length:e.length}})),Object(A.a)(J,Y.ITEM,(function(e,t){return Object(l.a)(Object(l.a)({client:e.id.client,clock:e.id.clock},function(e){return(4&e.info)>0?{deleted:!0}:{}}(e)),{},{content:q(e.content,t)})})),Object(A.a)(J,Y.CONTENT_ANY,(function(e){return{value:e.arr}})),Object(A.a)(J,Y.CONTENT_BINARY,(function(e){return{binary:e.content}})),Object(A.a)(J,Y.CONTENT_DELETED,(function(e){return{length:e.len}})),Object(A.a)(J,Y.CONTENT_DOC,(function(e){return{doc:e.doc}})),Object(A.a)(J,Y.CONTENT_EMBED,(function(e){return{embed:e.embed}})),Object(A.a)(J,Y.CONTENT_FORMAT,(function(e){return{key:e.key,value:e.value}})),Object(A.a)(J,Y.CONTENT_JSON,(function(e){return{json:e.arr}})),Object(A.a)(J,Y.CONTENT_STRING,(function(e){return{string:e.str}})),Object(A.a)(J,Y.CONTENT_TYPE,(function(e,t){return{value:q(e.type,t)}})),J);function q(e,t){console.assert(t,"pass Y");var n=function(e,t){switch(e.constructor){case t.Doc:return Y.DOC;case t.Array:return Y.Y_ARRAY;case t.Map:return Y.Y_MAP;case t.Text:return Y.Y_TEXT;case t.XmlElement:return Y.Y_XML_ELEMENT;case t.XmlFragment:return Y.Y_XML_FRAGMENT;case t.XmlText:return Y.Y_XML_TEXT;case t.AbstractType:return Y.ABSTRACT_TYPE;case t.Item:return Y.ITEM;case t.GC:return Y.GC;case t.Skip:return Y.Skip;case t.AbstractStruct:return Y.ABSTRACT_STRUCT;case t.ContentAny:return Y.CONTENT_ANY;case t.ContentBinary:return Y.CONTENT_BINARY;case t.ContentDeleted:return Y.CONTENT_DELETED;case t.ContentEmbed:return Y.CONTENT_EMBED;case t.ContentFormat:return Y.CONTENT_FORMAT;case t.ContentJSON:return Y.CONTENT_JSON;case t.ContentString:return Y.CONTENT_STRING;case t.ContentType:return Y.CONTENT_TYPE;default:return null}}(e,t),c=V[n];if(!c)return{type:n,error:"Unexpected type ".concat(n)};var r=c(e,t);return console.assert(void 0===r.type,"should not include type"),Object(l.a)({type:n},r)}n(48);var Q,Z=(Q={},Object(A.a)(Q,Y.CONTENT_STRING,(function(e){return Object(v.jsx)("div",{className:"string",children:e.string})})),Object(A.a)(Q,Y.CONTENT_DELETED,(function(e){return Object(v.jsx)("div",{className:"length",children:e.length})})),Object(A.a)(Q,Y.CONTENT_TYPE,(function(e){return Object(v.jsx)("div",{className:"content-type",children:e.value.type})})),Object(A.a)(Q,Y.CONTENT_ANY,(function(e){return Object(v.jsx)("div",{className:"content-any",children:e.value})})),Object(A.a)(Q,Y.CONTENT_BINARY,(function(){return Object(v.jsx)("div",{className:"content-binary",children:"Binary"})})),Q);function $(e){return Object(v.jsxs)("div",{children:["Unsupported content type: ",e.type]})}function ee(e){var t,n=e.struct,c=n.content,r=n.deleted,a=n.client,o=n.clock;return Object(v.jsxs)("div",{className:"struct ".concat(c.type," ").concat(r||c.type===Y.CONTENT_DELETED?"deleted":""," ").concat(e.isFocusedClientId(a)?"focused":""),children:[Object(v.jsxs)("div",{className:"client",children:["Doc",null===(t=e.getDocByClientId(a))||void 0===t?void 0:t.id]}),Object(v.jsx)("div",{className:"clock",children:o}),(Z[c.type]||$)(c)]})}n(49);function te(e){return Object(v.jsx)("span",{className:"collapse ".concat(e.collapsed?"collapsed":""),onClick:e.onClick})}function ne(e){return Object(v.jsxs)("span",{className:"value string",children:['"',e.string,'"']})}function ce(e){return Object(v.jsx)("span",{className:"value number",children:e.number})}function re(e){return Object(v.jsx)("span",{className:"value boolean",children:e.boolean})}function ae(e){return Object(v.jsx)("span",{className:"value null",children:e.value})}function oe(e){var t=Object(c.useState)(!0),n=Object(p.a)(t,2),r=n[0],a=n[1];var o=Object.keys(e.object);return Object(v.jsxs)("span",{className:"value object",children:[Object(v.jsxs)("span",{className:"object-description",children:[Object(v.jsx)(te,{collapsed:r,onClick:function(){a(!r)}}),Object(v.jsx)("span",{className:"description",children:"Object()"})]}),!r&&o.map((function(t){return Object(v.jsxs)("div",{className:"object-item",children:[Object(v.jsx)("span",{className:"object-key",children:t}),Object(v.jsx)("span",{children:":"}),Object(v.jsx)("span",{className:"object-value",children:Object(v.jsx)(ie,{value:e.object[t]})})]},t)}))]})}function se(e){var t=Object(c.useState)(!0),n=Object(p.a)(t,2),r=n[0],a=n[1];return Object(v.jsxs)("div",{className:"value array",children:[Object(v.jsxs)("div",{className:"array-description",children:[Object(v.jsx)(te,{collapsed:r,onClick:function(){a(!r)}}),Object(v.jsx)("span",{children:"Array(".concat(e.array.length,")")})]}),!r&&e.array.map((function(t,n){return Object(v.jsxs)("div",{className:"array-item",children:[Object(v.jsx)("span",{className:"array-key",children:n}),Object(v.jsx)("span",{children:":"}),Object(v.jsx)("span",{className:"array-value",children:Object(v.jsx)(ie,{value:e.array[n]})})]},n)}))]})}function ie(e){return"string"===typeof e.value?Object(v.jsx)(ne,{string:e.value}):"number"===typeof e.value?Object(v.jsx)(ce,{number:e.value}):"boolean"===typeof e.value?Object(v.jsx)(re,{boolean:e.value}):null===e.value||void 0===e.value?Object(v.jsx)(ae,{value:e.value}):Array.isArray(e.value)?Object(v.jsx)(se,{array:e.value}):Object(v.jsx)(oe,{object:e.value})}n(50);function ue(e){var t=q(e.value,j);return t.type===Y.Y_TEXT?Object(v.jsxs)("div",{className:"abstract-type",children:[Object(v.jsxs)("div",{className:"abstract-type-name",children:[e.name,":"]}),Object(v.jsx)("div",{className:"abstract-type-value",children:t.text.map((function(t){return Object(v.jsx)(ee,{struct:t,isFocusedClientId:e.isFocusedClientId,getDocByClientId:e.getDocByClientId},"".concat(t.client,"-").concat(t.clock))}))})]}):Object(v.jsx)(ie,{value:t})}function le(e){var t=Array.from(e.yDoc.share.keys());return Object(v.jsx)("div",{className:"data-source-share",children:t.map((function(t){return Object(v.jsx)(ue,{name:t,value:e.yDoc.share.get(t),getDocByClientId:e.getDocByClientId,isFocusedClientId:e.isFocusedClientId},t)}))})}n(51);function de(e){return Array.from(e.missing.keys()).map((function(t){return Object(v.jsxs)("p",{children:[Object(v.jsxs)("span",{className:"client-id",children:[t,":"]}),Object(v.jsx)("span",{children:e.missing.get(t)})]},t)}))}function pe(e){return Array.from(e.clients.keys()).map((function(t){return Object(v.jsxs)("div",{className:"client-container",children:[Object(v.jsxs)("div",{className:"client-id",children:["clientID: ",t]}),Object(v.jsx)("div",{className:"client-structs",children:e.clients.get(t).map((function(t){var n=q(t,j);return Object(v.jsx)(ee,{struct:n,isFocusedClientId:e.isFocusedClientId,getDocByClientId:e.getDocByClientId},"".concat(n.client,"-").concat(n.clock))}))})]},t)}))}function je(e){return Object(v.jsxs)("div",{className:"data-source-store",children:[e.yDoc.store.pendingStructs&&Object(v.jsxs)("div",{className:"pending-structs",children:[Object(v.jsx)("p",{children:"Missing:"}),Object(v.jsx)(de,{missing:e.yDoc.store.pendingStructs.missing})]}),Object(v.jsx)(pe,{clients:e.yDoc.store.clients,isFocusedClientId:e.isFocusedClientId,getDocByClientId:e.getDocByClientId})]})}n(52);function Oe(e){return Object(v.jsx)("div",{className:"y-doc-model",children:e.dataSource===I.SHARE?Object(v.jsx)(le,{yDoc:e.yDoc,getDocByClientId:e.getDocByClientId,isFocusedClientId:e.isFocusedClientId}):Object(v.jsx)(je,{yDoc:e.yDoc,getDocByClientId:e.getDocByClientId,isFocusedClientId:e.isFocusedClientId})})}n(53);function be(e){function t(t){var n=e.getDocByClientId(t);return(null===n||void 0===n?void 0:n.id)===e.focusedDocId}return Object(v.jsxs)("div",{className:"doc-container",onClick:e.onFocus,children:[Object(v.jsx)(C,{doc:e.doc,onCloseDoc:e.onCloseDoc,editable:e.editable}),Object(v.jsx)(S,{doc:e.doc,onEditorChange:e.onEditorChange,editable:e.editable,focused:t(e.doc.yDoc.clientID)}),Object(v.jsx)(k,{doc:e.doc,docs:e.docs,onSync:e.onSync,editable:e.editable}),Object(v.jsx)(Oe,{yDoc:e.doc.yDoc,dataSource:e.dataSource,getDocByClientId:e.getDocByClientId,isFocusedClientId:t})]})}function fe(e){return Object(v.jsxs)("span",{className:"buttons-container",children:[Object(v.jsx)("span",{children:"Actions: "}),Object(v.jsx)("button",{onClick:function(){e.onOpenDoc()},children:"Open a new doc"})]})}n(54);var he="option-gc",ye="option-pud";function xe(e){return e.target.value}function Ne(e){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xe;return function(c){e.onOptionChange(Object(A.a)({},t,n(c)))}}return Object(v.jsxs)("span",{className:"options-container",children:[Object(v.jsx)("label",{htmlFor:he,children:"GC:"}),Object(v.jsx)("input",{id:he,type:"checkbox",checked:e.options.gc,onChange:t("gc",(function(e){return e.target.checked}))}),Object(v.jsx)("label",{htmlFor:ye,children:"PermanentUserData:"}),Object(v.jsx)("input",{id:ye,type:"checkbox",checked:e.options.pud,onChange:t("pud",(function(e){return e.target.checked}))})]})}function ve(e){return Object(v.jsxs)("div",{className:"actions-container",children:[Object(v.jsx)(fe,{onOpenDoc:e.onOpenDoc}),Object(v.jsx)(Ne,{options:e.options,onOptionChange:e.onOptionChange})]})}var Te={DocEdit:[[b],[f,{id:0,actions:[{type:x,pos:0,str:"FOO"}]}],[f,{id:0,actions:[{type:N,pos:1,len:1}]}],[f,{id:0,actions:[{type:x,pos:1,str:"T"}]}],[f,{id:0,actions:[{type:x,pos:1,str:"B"}]}]],TwoDocsSyncWithoutConflicts:[[b],[b],[f,{id:0,actions:[{type:x,pos:0,str:"FOO"}]}],[h,{from:0,to:1}],[f,{id:1,actions:[{type:N,pos:1,len:1}]}],[f,{id:1,actions:[{type:x,pos:1,str:"T"}]}],[h,{from:1,to:0}]],TwoDocsSyncWithConflicts:[[b],[b],[f,{id:0,actions:[{type:x,pos:0,str:"FOO"}]}],[h,{from:0,to:1}],[f,{id:0,actions:[{type:x,pos:3,str:"B"}]}],[f,{id:1,actions:[{type:x,pos:3,str:"T"}]}],[h,{from:1,to:0}],[h,{from:0,to:1}]],TwoDocsSyncWithLostUpdates:[[b],[b],[f,{id:0,actions:[{type:x,pos:0,str:"FOO"}]}],[h,{from:0,to:1}],[f,{id:0,actions:[{type:x,pos:3,str:"B"}]}],[f,{id:0,actions:[{type:x,pos:4,str:"AR"}]}],[f,{id:1,actions:[{type:x,pos:3,str:"T"}]}],[h,{from:0,to:1,index:1}],[h,{from:1,to:0}],[h,{from:0,to:1,index:0}]]};function me(e){return new Promise((function(t){setTimeout(t,e)}))}function Ce(e){function t(t){e.onOptionChange({dataSource:t.target.value})}return Object(v.jsxs)("div",{className:"view-options-container",children:[Object(v.jsx)("label",{children:"Data source:"}),[{id:I.SHARE,label:"Share"},{id:I.STORE,label:"Store"}].map((function(n){return Object(v.jsxs)("span",{children:[Object(v.jsx)("input",{id:n.id,type:"radio",value:n.id,checked:e.options.dataSource===n.id,onChange:t}),Object(v.jsx)("label",{htmlFor:n.id,children:n.label})]},n.id)}))]})}n(55);function ge(){var e,t=Object(c.useState)((e="scenario",new URL(window.location.href).searchParams.get(e)||O)),n=Object(p.a)(t,2),r=n[0],a=n[1],o=Object(c.useState)(0),s=Object(p.a)(o,2),T=s[0],C=s[1],E=Object(c.useState)([]),D=Object(p.a)(E,2),S=D[0],_=D[1],k=Object(c.useState)({gc:!1,pud:!1}),A=Object(p.a)(k,2),w=A[0],Y=A[1],R=Object(c.useState)({dataSource:I.SHARE}),M=Object(p.a)(R,2),B=M[0],F=M[1],L=Object(c.useState)(null),X=Object(p.a)(L,2),G=X[0],J=X[1];function H(e){_(e),window.docs=e}function K(e,t){return W.apply(this,arguments)}function W(){return(W=Object(d.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=[],e.t1=Object(u.a)(S.slice(0,t)),e.next=4,n(S[t]);case 4:e.t2=e.sent,e.t3=[e.t2],e.t4=Object(u.a)(S.slice(t+1)),H(e.t0.concat.call(e.t0,e.t1,e.t3,e.t4));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(){return(z=Object(d.a)(i.a.mark((function e(){var t,n,c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C(T+1),t=Te[r],n=Object(p.a)(t[T],2),c=n[0],a=n[1],e.t0=c,e.next=e.t0===b?6:e.t0===f?9:e.t0===h?12:e.t0===y?15:18;break;case 6:return e.next=8,V();case 8:return e.abrupt("break",19);case 9:return e.next=11,$(a);case 11:return e.abrupt("break",19);case 12:return e.next=14,te(a);case 14:return e.abrupt("break",19);case 15:return e.next=17,Q(a);case 17:return e.abrupt("break",19);case 18:throw new Error("Unexpected action: "+c);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return q.apply(this,arguments)}function q(){return(q=Object(d.a)(i.a.mark((function e(){var t,n,c,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=new j.Doc).gc=w.gc,n=S.length,(c=S.filter(Boolean)).length&&n!==c[0].id&&j.applyUpdate(t,j.encodeStateAsUpdate(c[0].yDoc)),r=null,!w.pud){e.next=11;break}return(r=new j.PermanentUserData(t)).setUserMapping(t,t.clientID,"Doc".concat(n)),e.next=11,me(0);case 11:a=j.encodeStateAsUpdate(t),c.forEach((function(e){j.applyUpdate(e.yDoc,a)})),H([].concat(Object(u.a)(S),[{id:n,yDoc:t,pud:r,updates:[]}]));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(d.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.yDoc.destroy(),e.next=3,K(t.id,(function(){return null}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e){return ee.apply(this,arguments)}function ee(){return(ee=Object(d.a)(i.a.mark((function e(t){var n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,c=t.actions,e.next=3,K(n,function(){var e=Object(d.a)(i.a.mark((function e(t){var r,a,o,s,d,p,O,b,f,h,y,v;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=j.encodeStateVector(t.yDoc),o=0;case 3:if(!(o<c.length)){e.next=26;break}s=c[o],d=s.type,p=s.pos,O=s.str,b=s.len,f=t.yDoc.getText(g),e.t0=d,e.next=e.t0===x?10:e.t0===N?12:14;break;case 10:return f.insert(p,O),e.abrupt("break",15);case 12:return f.delete(p,b),e.abrupt("break",15);case 14:throw new Error("Unexpected type");case 15:return e.next=17,me(0);case 17:h=j.encodeStateAsUpdate(t.yDoc,a),y=P(h),(v={items:y.clientsStructs[t.yDoc.clientID]||[],deleteSet:y.deleteSet.clients[t.yDoc.clientID]||[]}).items.forEach((function(e){if("binary"===e.type){var t=U(e.content);Object.keys(t).length&&(e.decodedContent=t),e.content="[...]"}})),console.log("update",v),r.push({action:s,payload:h,syncedIds:[n]});case 23:o++,e.next=3;break;case 26:if(1!==S.length){e.next=28;break}return e.abrupt("return",t);case 28:return e.abrupt("return",Object(l.a)(Object(l.a)({},t),{},{updates:[].concat(Object(u.a)(t.updates),r)}));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){return ne.apply(this,arguments)}function ne(){return(ne=Object(d.a)(i.a.mark((function e(t){var n,c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.from,c=t.to,r=t.index,e.next=3,K(n,(function(e){if(e){var t=S[c],n=void 0===r?e.updates:[e.updates[r]];return n.forEach((function(e){j.applyUpdate(t.yDoc,e.payload)})),Object(l.a)(Object(l.a)({},e),{},{updates:e.updates.map((function(e){return n.includes(e)?e.syncedIds.includes(c)?e:Object(l.a)(Object(l.a)({},e),{},{syncedIds:[].concat(Object(u.a)(e.syncedIds),[c])}):e})).filter((function(e){return e.syncedIds.length!==S.filter(Boolean).length}))})}}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e){return S.find((function(t){return t&&t.yDoc.clientID===e}))}function re(e){return function(){J(e.id)}}var ae=r===O;return Object(v.jsxs)("div",{className:"App",children:[Object(v.jsx)(m,{scenarios:Te,currentScenario:r,currentScenarioStepIndex:T,onScenarioChange:function(e){a(e),C(0),H([])},onNextStep:function(){return z.apply(this,arguments)},onRestartStep:function(){C(0),H([])},onOpenDoc:V}),!Te[r]&&Object(v.jsx)(ve,{onOpenDoc:V,options:w,onOptionChange:function(e){Y(Object(l.a)(Object(l.a)({},w),e))}}),Object(v.jsx)(Ce,{options:B,onOptionChange:function(e){F(Object(l.a)(Object(l.a)({},B),e))}}),Object(v.jsx)("div",{className:"docs-container",children:S.filter(Boolean).map((function(e){return Object(v.jsx)(be,{doc:e,docs:S,editable:ae,dataSource:B.dataSource,onCloseDoc:Q,onEditorChange:$,onSync:te,getDocByClientId:ce,onFocus:re(e),focusedDocId:G},e.id)}))})]})}o.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(ge,{})}),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.73797214.chunk.js.map