(this["webpackJsonpdata-visualization"]=this["webpackJsonpdata-visualization"]||[]).push([[0],{35:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var c=n(15),r=n.n(c),a=n(29),o=n.n(a),s=(n(35),n(18)),i=n.n(s),u=n(14),l=n(17),d=n(20),p=n(8),j=n(16),b="CUSTOM_SCENARIO",f="DOC_OPEN",h="DOC_UPDATE",O="DOC_SYNC",y="DOC_CLOSE",x="INSERT",v="DELETE",m=(n(37),n(0));function g(e){var t=Object(p.a)(e,2),n=t[0],c=t[1];switch(n){case f:return n;case h:var r=c.id;return c.actions.map((function(e){if(e.type===x)return"".concat(n," Doc:").concat(r," type:").concat(e.type," pos:").concat(e.pos," str:").concat(e.str);if(e.type===v)return"".concat(n," Doc:").concat(r," type:").concat(e.type," pos:").concat(e.pos," len:").concat(e.len);throw new Error("Unexpect edit type: "+e.type)})).join(" ; ");case O:return void 0===c.index?"".concat(n," FromDoc:").concat(c.from," ToDoc:").concat(c.to):"".concat(n," FromDoc:").concat(c.from," ToDoc:").concat(c.to," updateIndex:").concat(c.index);case y:return n;default:throw new Error("Expected action: "+n)}}function C(e){var t="scenarios";var n=e.scenarios[e.currentScenario],c=n&&n[e.currentScenarioStepIndex-1],r=n&&n[e.currentScenarioStepIndex];return Object(m.jsxs)("div",{className:"scenarios",children:[Object(m.jsx)("label",{htmlFor:t,children:"Scenarios: "}),Object(m.jsxs)("select",{id:t,onChange:function(t){t.target.value!==e.currentScenario&&e.onScenarioChange(t.target.value)},children:[Object(m.jsx)("option",{value:b,children:"Custom"}),Object.keys(e.scenarios).map((function(e){return Object(m.jsx)("option",{value:e,children:e},e)}))]}),n&&Object(m.jsx)("button",{disabled:e.currentScenario===b,onClick:function(){var t=e.scenarios[e.currentScenario];e.currentScenarioStepIndex<t.length?e.onNextStep():e.onRestartStep()},className:"next-step-button",children:r?"Next step":"Restart"}),r&&Object(m.jsx)("span",{className:"next-step",children:g(r)}),c&&Object(m.jsxs)("p",{className:"current-step",children:[Object(m.jsx)("span",{className:"current-step-label",children:"Current step: "}),Object(m.jsx)("span",{children:g(c)})]})]})}n(39);function D(e){return Object(m.jsxs)("div",{className:"doc-tab",children:[e.editable&&Object(m.jsx)("button",{className:"doc-close",onClick:function(){e.onCloseDoc(e.doc)},children:"x"}),Object(m.jsxs)("p",{className:"doc-id",children:["Doc",e.doc.id]}),Object(m.jsxs)("span",{className:"doc-options",children:[e.doc.yDoc.gc&&Object(m.jsx)("span",{children:"GC\u2714\ufe0f"}),e.doc.pud&&Object(m.jsx)("span",{children:"PermanentUserData\u2714\ufe0f"})]})]})}var S="sample-key";n(40);function k(e,t,n){var c=function(e,t,n){for(var c=Math.min(Math.max(e.length-1,0),Math.max(t.length-1,0),n),r=0;r<=c;r++)if(e[r]!==t[r])return r;return 0===e.length||0===t.length?0:c+1}(e,t,n),r=function(e,t,n){for(var c=Math.min(Math.max(e.length-1,0),Math.max(t.length-n,0)),r=0;r<=c;r++)if(e[e.length-1-r]!==t[t.length-1-r])return r;return c}(e,t,n);if(c+r>e.length-1||c+r>t.length-1){var a=function(e,t,n){if(e.length>t.length)return{type:v,pos:n,len:e.length-t.length};if(e.length<t.length){var c=n-(t.length-e.length);return{type:x,pos:c,str:t.slice(c,n)}}return null}(e,t,n);return a?[a]:[]}var o={pos:c,len:e.length-r-c},s={pos:c,str:t.slice(c,t.length-r)},i=[];return o.len&&i.push({type:v,pos:o.pos,len:o.len}),s.str.length&&i.push({type:x,pos:s.pos,str:s.str}),i}function N(e){return e.getText(S).toString()}function I(e){var t=Object(c.useRef)(null),n=Object(c.useRef)(N(e.doc.yDoc));return Object(c.useEffect)((function(){var c=N(e.doc.yDoc);t.current.textContent!==c&&(t.current.textContent=c),n.current!==c&&(n.current=c)})),Object(m.jsx)("p",{contentEditable:e.editable?"true":"false",className:"editor ".concat(e.focused?"focused":""),onInput:function(t){var c=t.target.textContent;if(n.current!==c){var r=window.getSelection().getRangeAt(0).startOffset,a=k(n.current,c,r);a.length&&(n.current=c,e.onEditorChange({id:e.doc.id,actions:a}))}},ref:t})}n(41);function w(e){return"".concat(e.type," ").concat(e.pos," ").concat(e.str||e.len)}function E(e){function t(t,n){return function(){e.onSync({from:e.doc.id,to:t,index:n})}}return Object(m.jsx)("div",{className:"updates",children:e.doc.updates.map((function(n,c){return Object(m.jsxs)("p",{className:"update",children:[Object(m.jsx)("span",{className:"update-detail".concat(n.action.type===x?" insert":" delete"),children:w(n.action)}),e.editable&&e.docs.filter((function(e){return e&&!n.syncedIds.includes(e.id)})).map((function(e){return Object(m.jsxs)("button",{className:"sync-button",onClick:t(e.id,c),children:["To Doc",e.id]},e.id)}))]},c+w(n.action))}))})}var F,T={SHARE:"share",STORE:"store"},A=n(6),B=n(13),U="Doc",R="AbstractType",M="YArray",Y="YMap",P="YText",_="YXmlElement",X="YXmlFragment",J="YXmlText",G="AbstractStruct",H="GC",L="Item",W="Skip",z="ContentAny",K="ContentBinary",V="ContentDeleted",q="ContentDoc",Q="ContentEmbed",Z="ContentFormat",$="ContentJSON",ee="ContentString",te="ContentType";function ne(e,t){var n,c={},r=Object(B.a)(e._map);try{for(r.s();!(n=r.n()).done;){var a=Object(p.a)(n.value,2),o=a[0],s=a[1];c[o]=ae(s,t)}}catch(i){r.e(i)}finally{r.f()}return c}function ce(e,t){for(var n=[],c=e._start;null!==c;)n.push(ae(c,t)),c=c.right;return n}var re=(F={},Object(A.a)(F,U,(function(e,t){var n,c={share:{},store:{clients:{},pendingDs:null,pendingStructs:null}},r=Object(B.a)(e.share);try{for(r.s();!(n=r.n()).done;){var a=Object(p.a)(n.value,2),o=a[0],s=a[1];c.share[o]=ae(s,t)}}catch(b){r.e(b)}finally{r.f()}var i,u=Object(B.a)(e.store.clients);try{for(u.s();!(i=u.n()).done;){var l=Object(p.a)(i.value,2),d=l[0],j=l[1];c.store.clients[d]=j.map((function(e){return ae(e,t)}))}}catch(b){u.e(b)}finally{u.f()}return c})),Object(A.a)(F,M,(function(e,t){return{array:ce(e,t)}})),Object(A.a)(F,Y,(function(e,t){return{map:ne(e,t)}})),Object(A.a)(F,P,(function(e,t){return{text:ce(e,t)}})),Object(A.a)(F,_,(function(e,t){return{nodeName:e.nodeName,attributes:ne(e,t),children:ce(e,t)}})),Object(A.a)(F,X,(function(e,t){return{children:ce(e,t)}})),Object(A.a)(F,J,(function(e,t){return{xmlText:ce(e,t)}})),Object(A.a)(F,H,(function(e){return{client:e.id.client,clock:e.id.clock,length:e.length}})),Object(A.a)(F,L,(function(e,t){return Object(l.a)(Object(l.a)({client:e.id.client,clock:e.id.clock},function(e){return(4&e.info)>0?{deleted:!0}:{}}(e)),{},{content:ae(e.content,t)})})),Object(A.a)(F,z,(function(e){return{value:e.arr}})),Object(A.a)(F,K,(function(e){return{binary:e.content}})),Object(A.a)(F,V,(function(e){return{length:e.len}})),Object(A.a)(F,q,(function(e){return{doc:e.doc}})),Object(A.a)(F,Q,(function(e){return{embed:e.embed}})),Object(A.a)(F,Z,(function(e){return{key:e.key,value:e.value}})),Object(A.a)(F,$,(function(e){return{json:e.arr}})),Object(A.a)(F,ee,(function(e){return{string:e.str}})),Object(A.a)(F,te,(function(e,t){return{value:ae(e.type,t)}})),F);function ae(e,t){console.assert(t,"pass Y");var n=function(e,t){switch(e.constructor){case t.Doc:return U;case t.Array:return M;case t.Map:return Y;case t.Text:return P;case t.XmlElement:return _;case t.XmlFragment:return X;case t.XmlText:return J;case t.AbstractType:return R;case t.Item:return L;case t.GC:return H;case t.Skip:return W;case t.AbstractStruct:return G;case t.ContentAny:return z;case t.ContentBinary:return K;case t.ContentDeleted:return V;case t.ContentEmbed:return Q;case t.ContentFormat:return Z;case t.ContentJSON:return $;case t.ContentString:return ee;case t.ContentType:return te;default:return null}}(e,t),c=re[n];if(!c)return{type:n,error:"Unexpected type ".concat(n)};var r=c(e,t);return console.assert(void 0===r.type,"should not include type"),Object(l.a)({type:n},r)}n(42);var oe,se=(oe={},Object(A.a)(oe,ee,(function(e){return Object(m.jsx)("div",{className:"string",children:e.string})})),Object(A.a)(oe,V,(function(e){return Object(m.jsx)("div",{className:"length",children:e.length})})),Object(A.a)(oe,te,(function(e){return Object(m.jsx)("div",{className:"content-type",children:e.value.type})})),Object(A.a)(oe,z,(function(e){return Object(m.jsx)("div",{className:"content-any",children:e.value})})),Object(A.a)(oe,K,(function(){return Object(m.jsx)("div",{className:"content-binary",children:"Binary"})})),oe);function ie(e){return Object(m.jsxs)("div",{children:["Unsupported content type: ",e.type]})}function ue(e){var t,n=e.struct,c=n.content,r=n.deleted,a=n.client,o=n.clock;return Object(m.jsxs)("div",{className:"struct ".concat(c.type," ").concat(r||c.type===V?"deleted":""," ").concat(e.isFocusedClientId(a)?"focused":""),children:[Object(m.jsxs)("div",{className:"client",children:["Doc",null===(t=e.getDocByClientId(a))||void 0===t?void 0:t.id]}),Object(m.jsx)("div",{className:"clock",children:o}),(se[c.type]||ie)(c)]})}n(43);function le(e){return Object(m.jsx)("span",{className:"collapse ".concat(e.collapsed?"collapsed":""),onClick:e.onClick})}function de(e){return Object(m.jsxs)("span",{className:"value string",children:['"',e.string,'"']})}function pe(e){return Object(m.jsx)("span",{className:"value number",children:e.number})}function je(e){return Object(m.jsx)("span",{className:"value boolean",children:e.boolean})}function be(e){return Object(m.jsx)("span",{className:"value null",children:e.value})}function fe(e){var t=Object(c.useState)(!0),n=Object(p.a)(t,2),r=n[0],a=n[1];var o=Object.keys(e.object);return Object(m.jsxs)("span",{className:"value object",children:[Object(m.jsxs)("span",{className:"object-description",children:[Object(m.jsx)(le,{collapsed:r,onClick:function(){a(!r)}}),Object(m.jsx)("span",{className:"description",children:"Object()"})]}),!r&&o.map((function(t){return Object(m.jsxs)("div",{className:"object-item",children:[Object(m.jsx)("span",{className:"object-key",children:t}),Object(m.jsx)("span",{children:":"}),Object(m.jsx)("span",{className:"object-value",children:Object(m.jsx)(Oe,{value:e.object[t]})})]},t)}))]})}function he(e){var t=Object(c.useState)(!0),n=Object(p.a)(t,2),r=n[0],a=n[1];return Object(m.jsxs)("div",{className:"value array",children:[Object(m.jsxs)("div",{className:"array-description",children:[Object(m.jsx)(le,{collapsed:r,onClick:function(){a(!r)}}),Object(m.jsx)("span",{children:"Array(".concat(e.array.length,")")})]}),!r&&e.array.map((function(t,n){return Object(m.jsxs)("div",{className:"array-item",children:[Object(m.jsx)("span",{className:"array-key",children:n}),Object(m.jsx)("span",{children:":"}),Object(m.jsx)("span",{className:"array-value",children:Object(m.jsx)(Oe,{value:e.array[n]})})]},n)}))]})}function Oe(e){return"string"===typeof e.value?Object(m.jsx)(de,{string:e.value}):"number"===typeof e.value?Object(m.jsx)(pe,{number:e.value}):"boolean"===typeof e.value?Object(m.jsx)(je,{boolean:e.value}):null===e.value||void 0===e.value?Object(m.jsx)(be,{value:e.value}):Array.isArray(e.value)?Object(m.jsx)(he,{array:e.value}):Object(m.jsx)(fe,{object:e.value})}n(44);function ye(e){var t=ae(e.value,j);return t.type===P?Object(m.jsxs)("div",{className:"abstract-type",children:[Object(m.jsxs)("div",{className:"abstract-type-name",children:[e.name,":"]}),Object(m.jsx)("div",{className:"abstract-type-value",children:t.text.map((function(t){return Object(m.jsx)(ue,{struct:t,isFocusedClientId:e.isFocusedClientId,getDocByClientId:e.getDocByClientId},"".concat(t.client,"-").concat(t.clock))}))})]}):Object(m.jsx)(Oe,{value:t})}function xe(e){var t=Array.from(e.yDoc.share.keys());return Object(m.jsx)("div",{className:"data-source-share",children:t.map((function(t){return Object(m.jsx)(ye,{name:t,value:e.yDoc.share.get(t),getDocByClientId:e.getDocByClientId,isFocusedClientId:e.isFocusedClientId},t)}))})}n(51);function ve(e){return Array.from(e.missing.keys()).map((function(t){return Object(m.jsxs)("p",{children:[Object(m.jsxs)("span",{className:"client-id",children:[t,":"]}),Object(m.jsx)("span",{children:e.missing.get(t)})]},t)}))}function me(e){return Array.from(e.clients.keys()).map((function(t){return Object(m.jsxs)("div",{className:"client-container",children:[Object(m.jsxs)("div",{className:"client-id",children:["clientID: ",t]}),Object(m.jsx)("div",{className:"client-structs",children:e.clients.get(t).map((function(t){var n=ae(t,j);return Object(m.jsx)(ue,{struct:n,isFocusedClientId:e.isFocusedClientId,getDocByClientId:e.getDocByClientId},"".concat(n.client,"-").concat(n.clock))}))})]},t)}))}function ge(e){return Object(m.jsxs)("div",{className:"data-source-store",children:[e.yDoc.store.pendingStructs&&Object(m.jsxs)("div",{className:"pending-structs",children:[Object(m.jsx)("p",{children:"Missing:"}),Object(m.jsx)(ve,{missing:e.yDoc.store.pendingStructs.missing})]}),Object(m.jsx)(me,{clients:e.yDoc.store.clients,isFocusedClientId:e.isFocusedClientId,getDocByClientId:e.getDocByClientId})]})}n(52);function Ce(e){return Object(m.jsx)("div",{className:"y-doc-model",children:e.dataSource===T.SHARE?Object(m.jsx)(xe,{yDoc:e.yDoc,getDocByClientId:e.getDocByClientId,isFocusedClientId:e.isFocusedClientId}):Object(m.jsx)(ge,{yDoc:e.yDoc,getDocByClientId:e.getDocByClientId,isFocusedClientId:e.isFocusedClientId})})}n(53);function De(e){function t(t){var n=e.getDocByClientId(t);return(null===n||void 0===n?void 0:n.id)===e.focusedDocId}return Object(m.jsxs)("div",{className:"doc-container",onClick:e.onFocus,children:[Object(m.jsx)(D,{doc:e.doc,onCloseDoc:e.onCloseDoc,editable:e.editable}),Object(m.jsx)(I,{doc:e.doc,onEditorChange:e.onEditorChange,editable:e.editable,focused:t(e.doc.yDoc.clientID)}),Object(m.jsx)(E,{doc:e.doc,docs:e.docs,onSync:e.onSync,editable:e.editable}),Object(m.jsx)(Ce,{yDoc:e.doc.yDoc,dataSource:e.dataSource,getDocByClientId:e.getDocByClientId,isFocusedClientId:t})]})}function Se(e){return Object(m.jsxs)("span",{className:"buttons-container",children:[Object(m.jsx)("span",{children:"Actions: "}),Object(m.jsx)("button",{onClick:function(){e.onOpenDoc()},children:"Open a new doc"})]})}n(54);var ke="option-gc",Ne="option-pud";function Ie(e){return e.target.value}function we(e){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ie;return function(c){e.onOptionChange(Object(A.a)({},t,n(c)))}}return Object(m.jsxs)("span",{className:"options-container",children:[Object(m.jsx)("label",{htmlFor:ke,children:"GC:"}),Object(m.jsx)("input",{id:ke,type:"checkbox",checked:e.options.gc,onChange:t("gc",(function(e){return e.target.checked}))}),Object(m.jsx)("label",{htmlFor:Ne,children:"PermanentUserData:"}),Object(m.jsx)("input",{id:Ne,type:"checkbox",checked:e.options.pud,onChange:t("pud",(function(e){return e.target.checked}))})]})}function Ee(e){return Object(m.jsxs)("div",{className:"actions-container",children:[Object(m.jsx)(Se,{onOpenDoc:e.onOpenDoc}),Object(m.jsx)(we,{options:e.options,onOptionChange:e.onOptionChange})]})}var Fe={DocEdit:[[f],[h,{id:0,actions:[{type:x,pos:0,str:"FOO"}]}],[h,{id:0,actions:[{type:v,pos:1,len:1}]}],[h,{id:0,actions:[{type:x,pos:1,str:"T"}]}],[h,{id:0,actions:[{type:x,pos:1,str:"B"}]}]],TwoDocsSyncWithoutConflicts:[[f],[f],[h,{id:0,actions:[{type:x,pos:0,str:"FOO"}]}],[O,{from:0,to:1}],[h,{id:1,actions:[{type:v,pos:1,len:1}]}],[h,{id:1,actions:[{type:x,pos:1,str:"T"}]}],[O,{from:1,to:0}]],TwoDocsSyncWithConflicts:[[f],[f],[h,{id:0,actions:[{type:x,pos:0,str:"FOO"}]}],[O,{from:0,to:1}],[h,{id:0,actions:[{type:x,pos:3,str:"B"}]}],[h,{id:1,actions:[{type:x,pos:3,str:"T"}]}],[O,{from:1,to:0}],[O,{from:0,to:1}]],TwoDocsSyncWithLostUpdates:[[f],[f],[h,{id:0,actions:[{type:x,pos:0,str:"FOO"}]}],[O,{from:0,to:1}],[h,{id:0,actions:[{type:x,pos:3,str:"B"}]}],[h,{id:0,actions:[{type:x,pos:4,str:"AR"}]}],[h,{id:1,actions:[{type:x,pos:3,str:"T"}]}],[O,{from:0,to:1,index:1}],[O,{from:1,to:0}],[O,{from:0,to:1,index:0}]]};function Te(e){return new Promise((function(t){setTimeout(t,e)}))}var Ae=n(3),Be=n(1),Ue=n(4),Re=n(12),Me=[function(){return new j.Array},function(){return new j.Map},function(){return new j.Text},function(e){Be.k(e)},function(e){},function(e){Be.k(e)},function(e){}];var Ye=[function(){throw Re.c()},function(e){return{type:"deleted",length:Be.l(e)}},function(e){for(var t=Be.l(e),n=[],c=0;c<t;c++){var r=Be.k(e);"undefined"===r?n.push(void 0):n.push(JSON.parse(r))}return{type:"json",content:n,length:t}},function(e){return{type:"binary",content:Be.m(e),length:1}},function(e){var t=Be.k(e);return{type:"string",string:t,length:t.length}},function(e){return{type:"embed",content:Be.k(e),length:1}},function(e){return{type:"format",content:{key:Be.k(e),value:Be.k(e)},length:1}},function(e){return{type:"type",content:Me[Be.l(e)](e),length:1}},function(e){for(var t=Be.l(e),n=[],c=0;c<t;c++){var r=Be.h(e);n.push(r)}return{type:"any",content:n,length:t}}];function Pe(e){e instanceof Be.a||(e=Be.f(e));for(var t={clients:{}},n=Be.l(e),c=0;c<n;c++){var r=Be.l(e),a=Be.l(e);if(a>0){t.clients[r]=[];for(var o=0;o<a;o++)t.clients[r].push({clock:Be.l(e),length:Be.l(e)})}}return t}function _e(e){var t=Be.f(e);return{clientsStructs:function(e){for(var t={},n=Be.l(e),c=0;c<n;c++){for(var r=Be.l(e),a=[],o=Xe(e),s=o.clock,i=o.client,u=0;u<r;u++){var l=Be.i(e),d=void 0;d=0!==(Ue.i&l)?Ge(i,s,e,l):new Je(i,s,{length:Be.l(e)}),a.push(d),s+=d.length}t[i]=a}return t}(t),deleteSet:Pe(t)}}function Xe(e){return{client:Be.l(e),clock:Be.l(e)}}var Je=function e(t,n,c,r,a,o,s,i,u){var l=this;Object(Ae.a)(this,e),this.client=t,this.clock=n,this.left=r,this.origin=a,this.right=o,this.rightOrigin=s,this.parentYKey=i,this.parent=u,Object.keys(c).forEach((function(e){l[e]=c[e]}))};function Ge(e,t,n,c){var r=(c&Ue.g)===Ue.g?Xe(n):null,a=(c&Ue.f)===Ue.f?Xe(n):null,o=0===(c&(Ue.f|Ue.g)),s=!!o&&1===Be.l(n),i=o&&s?Be.k(n):null,u=null;o&&!s&&(u=Xe(n)),o&&(c&Ue.e)===Ue.e&&Be.k(n);var l=function(e,t){return Ye[t&Ue.i](e)}(n,c);return new Je(e,t,l,null,r,null,a,i,u)}function He(e){function t(t){e.onOptionChange({dataSource:t.target.value})}return Object(m.jsxs)("div",{className:"view-options-container",children:[Object(m.jsx)("label",{children:"Data source:"}),[{id:T.SHARE,label:"Share"},{id:T.STORE,label:"Store"}].map((function(n){return Object(m.jsxs)("span",{children:[Object(m.jsx)("input",{id:n.id,type:"radio",value:n.id,checked:e.options.dataSource===n.id,onChange:t}),Object(m.jsx)("label",{htmlFor:n.id,children:n.label})]},n.id)}))]})}n(55);function Le(){var e,t=Object(c.useState)((e="scenario",new URL(window.location.href).searchParams.get(e)||b)),n=Object(p.a)(t,2),r=n[0],a=n[1],o=Object(c.useState)(0),s=Object(p.a)(o,2),g=s[0],D=s[1],k=Object(c.useState)([]),N=Object(p.a)(k,2),I=N[0],w=N[1],E=Object(c.useState)({gc:!1,pud:!1}),F=Object(p.a)(E,2),A=F[0],B=F[1],U=Object(c.useState)({dataSource:T.SHARE}),R=Object(p.a)(U,2),M=R[0],Y=R[1],P=Object(c.useState)(null),_=Object(p.a)(P,2),X=_[0],J=_[1];function G(e){w(e),window.docs=e}function H(e,t){return L.apply(this,arguments)}function L(){return(L=Object(d.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=[],e.t1=Object(u.a)(I.slice(0,t)),e.next=4,n(I[t]);case 4:e.t2=e.sent,e.t3=[e.t2],e.t4=Object(u.a)(I.slice(t+1)),G(e.t0.concat.call(e.t0,e.t1,e.t3,e.t4));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return(W=Object(d.a)(i.a.mark((function e(){var t,n,c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:D(g+1),t=Fe[r],n=Object(p.a)(t[g],2),c=n[0],a=n[1],e.t0=c,e.next=e.t0===f?6:e.t0===h?9:e.t0===O?12:e.t0===y?15:18;break;case 6:return e.next=8,z();case 8:return e.abrupt("break",19);case 9:return e.next=11,Q(a);case 11:return e.abrupt("break",19);case 12:return e.next=14,$(a);case 14:return e.abrupt("break",19);case 15:return e.next=17,V(a);case 17:return e.abrupt("break",19);case 18:throw new Error("Unexpected action: "+c);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(){return K.apply(this,arguments)}function K(){return(K=Object(d.a)(i.a.mark((function e(){var t,n,c,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=new j.Doc).gc=A.gc,n=I.length,(c=I.filter(Boolean)).length&&n!==c[0].id&&j.applyUpdate(t,j.encodeStateAsUpdate(c[0].yDoc)),r=null,!A.pud){e.next=11;break}return(r=new j.PermanentUserData(t)).setUserMapping(t,t.clientID,"Doc".concat(n)),e.next=11,Te(0);case 11:a=j.encodeStateAsUpdate(t),c.forEach((function(e){j.applyUpdate(e.yDoc,a)})),G([].concat(Object(u.a)(I),[{id:n,yDoc:t,pud:r,updates:[]}]));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){return q.apply(this,arguments)}function q(){return(q=Object(d.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.yDoc.destroy(),e.next=3,H(t.id,(function(){return null}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(d.a)(i.a.mark((function e(t){var n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,c=t.actions,e.next=3,H(n,function(){var e=Object(d.a)(i.a.mark((function e(t){var r,a,o,s,d,p,b,f,h,O,y,m;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=j.encodeStateVector(t.yDoc),o=0;case 3:if(!(o<c.length)){e.next=26;break}s=c[o],d=s.type,p=s.pos,b=s.str,f=s.len,h=t.yDoc.getText(S),e.t0=d,e.next=e.t0===x?10:e.t0===v?12:14;break;case 10:return h.insert(p,b),e.abrupt("break",15);case 12:return h.delete(p,f),e.abrupt("break",15);case 14:throw new Error("Unexpected type");case 15:return e.next=17,Te(0);case 17:O=j.encodeStateAsUpdate(t.yDoc,a),y=_e(O),(m={items:y.clientsStructs[t.yDoc.clientID]||[],deleteSet:y.deleteSet.clients[t.yDoc.clientID]||[]}).items.forEach((function(e){if("binary"===e.type){var t=Pe(e.content);Object.keys(t).length&&(e.decodedContent=t),e.content="[...]"}})),console.log("update",m),r.push({action:s,payload:O,syncedIds:[n]});case 23:o++,e.next=3;break;case 26:if(1!==I.length){e.next=28;break}return e.abrupt("return",t);case 28:return e.abrupt("return",Object(l.a)(Object(l.a)({},t),{},{updates:[].concat(Object(u.a)(t.updates),r)}));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e){return ee.apply(this,arguments)}function ee(){return(ee=Object(d.a)(i.a.mark((function e(t){var n,c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.from,c=t.to,r=t.index,e.next=3,H(n,(function(e){if(e){var t=I[c],n=void 0===r?e.updates:[e.updates[r]];return n.forEach((function(e){j.applyUpdate(t.yDoc,e.payload)})),Object(l.a)(Object(l.a)({},e),{},{updates:e.updates.map((function(e){return n.includes(e)?e.syncedIds.includes(c)?e:Object(l.a)(Object(l.a)({},e),{},{syncedIds:[].concat(Object(u.a)(e.syncedIds),[c])}):e})).filter((function(e){return e.syncedIds.length!==I.filter(Boolean).length}))})}}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){return I.find((function(t){return t.yDoc.clientID===e}))}function ne(e){return function(){J(e.id)}}var ce=r===b;return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)(C,{scenarios:Fe,currentScenario:r,currentScenarioStepIndex:g,onScenarioChange:function(e){a(e),D(0),G([])},onNextStep:function(){return W.apply(this,arguments)},onRestartStep:function(){D(0),G([])},onOpenDoc:z}),!Fe[r]&&Object(m.jsx)(Ee,{onOpenDoc:z,options:A,onOptionChange:function(e){B(Object(l.a)(Object(l.a)({},A),e))}}),Object(m.jsx)(He,{options:M,onOptionChange:function(e){Y(Object(l.a)(Object(l.a)({},M),e))}}),Object(m.jsx)("div",{className:"docs-container",children:I.filter(Boolean).map((function(e){return Object(m.jsx)(De,{doc:e,docs:I,editable:ce,dataSource:M.dataSource,onCloseDoc:V,onEditorChange:Q,onSync:$,getDocByClientId:te,onFocus:ne(e),focusedDocId:X},e.id)}))})]})}o.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(Le,{})}),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.24440ff9.chunk.js.map