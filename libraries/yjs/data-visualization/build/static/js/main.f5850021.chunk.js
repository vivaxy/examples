(this["webpackJsonpdata-visualization"]=this["webpackJsonpdata-visualization"]||[]).push([[0],{35:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var c=n(15),r=n.n(c),a=n(29),o=n.n(a),s=(n(35),n(17)),i=n.n(s),u=n(14),l=n(16),d=n(20),j=n(8),p=n(19),f="CUSTOM_SCENARIO",b="DOC_OPEN",h="DOC_UPDATE",O="DOC_SYNC",y="DOC_CLOSE",x="INSERT",v="DELETE",m=(n(37),n(0));function g(e){var t=Object(j.a)(e,2),n=t[0],c=t[1];switch(n){case b:return n;case h:var r=c.id;return c.actions.map((function(e){if(e.type===x)return"".concat(n," Doc:").concat(r," type:").concat(e.type," pos:").concat(e.pos," str:").concat(e.str);if(e.type===v)return"".concat(n," Doc:").concat(r," type:").concat(e.type," pos:").concat(e.pos," len:").concat(e.len);throw new Error("Unexpect edit type: "+e.type)})).join(" ; ");case O:return void 0===c.index?"".concat(n," FromDoc:").concat(c.from," ToDoc:").concat(c.to):"".concat(n," FromDoc:").concat(c.from," ToDoc:").concat(c.to," updateIndex:").concat(c.index);case y:return n;default:throw new Error("Expected action: "+n)}}function C(e){var t="scenarios";var n=e.scenarios[e.currentScenario],c=n&&n[e.currentScenarioStepIndex-1],r=n&&n[e.currentScenarioStepIndex];return Object(m.jsxs)("div",{className:"scenarios",children:[Object(m.jsx)("label",{htmlFor:t,children:"Scenarios: "}),Object(m.jsxs)("select",{id:t,onChange:function(t){t.target.value!==e.currentScenario&&e.onScenarioChange(t.target.value)},children:[Object(m.jsx)("option",{value:f,children:"Custom"}),Object.keys(e.scenarios).map((function(e){return Object(m.jsx)("option",{value:e,children:e},e)}))]}),n&&Object(m.jsx)("button",{disabled:e.currentScenario===f,onClick:function(){var t=e.scenarios[e.currentScenario];e.currentScenarioStepIndex<t.length?e.onNextStep():e.onRestartStep()},className:"next-step-button",children:r?"Next step":"Restart"}),r&&Object(m.jsx)("span",{className:"next-step",children:g(r)}),c&&Object(m.jsxs)("p",{className:"current-step",children:[Object(m.jsx)("span",{className:"current-step-label",children:"Current step: "}),Object(m.jsx)("span",{children:g(c)})]})]})}n(39);function D(e){return Object(m.jsxs)("div",{className:"doc-tab",children:[e.editable&&Object(m.jsx)("button",{className:"doc-close",onClick:function(){e.onCloseDoc(e.doc)},children:"x"}),Object(m.jsxs)("p",{className:"doc-id",children:["Doc",e.doc.id]}),Object(m.jsxs)("span",{className:"doc-options",children:[e.doc.yDoc.gc&&Object(m.jsx)("span",{children:"GC\u2714\ufe0f"}),e.doc.pud&&Object(m.jsx)("span",{children:"PermanentUserData\u2714\ufe0f"})]})]})}var k="sample-key";n(40);function S(e,t,n){var c=function(e,t,n){for(var c=Math.min(Math.max(e.length-1,0),Math.max(t.length-1,0),n),r=0;r<=c;r++)if(e[r]!==t[r])return r;return 0===e.length||0===t.length?0:c+1}(e,t,n),r=function(e,t,n){for(var c=Math.min(Math.max(e.length-1,0),Math.max(t.length-n,0)),r=0;r<=c;r++)if(e[e.length-1-r]!==t[t.length-1-r])return r;return c}(e,t,n);if(c+r>e.length-1||c+r>t.length-1){var a=function(e,t,n){if(e.length>t.length)return{type:v,pos:n,len:e.length-t.length};if(e.length<t.length){var c=n-(t.length-e.length);return{type:x,pos:c,str:t.slice(c,n)}}return null}(e,t,n);return a?[a]:[]}var o={pos:c,len:e.length-r-c},s={pos:c,str:t.slice(c,t.length-r)},i=[];return o.len&&i.push({type:v,pos:o.pos,len:o.len}),s.str.length&&i.push({type:x,pos:s.pos,str:s.str}),i}function N(e){return e.getText(k).toString()}function I(e){var t=Object(c.useRef)(null),n=Object(c.useRef)(N(e.doc.yDoc));return Object(c.useEffect)((function(){var c=N(e.doc.yDoc);t.current.textContent!==c&&(t.current.textContent=c),n.current!==c&&(n.current=c)})),Object(m.jsx)("p",{contentEditable:e.editable?"true":"false",className:"editor ".concat(e.focused?"focused":""),onInput:function(t){var c=t.target.textContent;if(n.current!==c){var r=window.getSelection().getRangeAt(0).startOffset,a=S(n.current,c,r);a.length&&(n.current=c,e.onEditorChange({id:e.doc.id,actions:a}))}},ref:t})}n(41);function w(e){return"".concat(e.type," ").concat(e.pos," ").concat(e.str||e.len)}function E(e){function t(t,n){return function(){e.onSync({from:e.doc.id,to:t,index:n})}}return Object(m.jsx)("div",{className:"updates",children:e.doc.updates.map((function(n,c){return Object(m.jsxs)("p",{className:"update",children:[Object(m.jsx)("span",{className:"update-detail".concat(n.action.type===x?" insert":" delete"),children:w(n.action)}),e.editable&&e.docs.filter((function(e){return e&&!n.syncedIds.includes(e.id)})).map((function(e){return Object(m.jsxs)("button",{className:"sync-button",onClick:t(e.id,c),children:["To Doc",e.id]},e.id)}))]},c+w(n.action))}))})}var F,B={SHARE:"share",STORE:"store"},T=n(6),A=n(13),R="Doc",U="YArray",M="YMap",Y="YText",_="YXmlElement",P="YXmlFragment",H="YXmlText",J="GC",L="Item",G="ContentAny",W="ContentBinary",X="ContentDeleted",z="ContentDoc",K="ContentEmbed",q="ContentFormat",Q="ContentJSON",V="ContentString",Z="ContentType";function $(e){var t,n={},c=Object(A.a)(e._map);try{for(c.s();!(t=c.n()).done;){var r=Object(j.a)(t.value,2),a=r[0],o=r[1];n[a]=ne(o)}}catch(s){c.e(s)}finally{c.f()}return n}function ee(e){for(var t=[],n=e._start;null!==n;)t.push(ne(n)),n=n.right;return t}var te=(F={},Object(T.a)(F,R,(function(e){var t,n={share:{},store:{clients:{},pendingDs:null,pendingStructs:null}},c=Object(A.a)(e.share);try{for(c.s();!(t=c.n()).done;){var r=Object(j.a)(t.value,2),a=r[0],o=r[1];n.share[a]=ne(o)}}catch(p){c.e(p)}finally{c.f()}var s,i=Object(A.a)(e.store.clients);try{for(i.s();!(s=i.n()).done;){var u=Object(j.a)(s.value,2),l=u[0],d=u[1];n.store.clients[l]=d.map((function(e){return ne(e)}))}}catch(p){i.e(p)}finally{i.f()}return n})),Object(T.a)(F,U,(function(e){return{array:ee(e)}})),Object(T.a)(F,M,(function(e){return{map:$(e)}})),Object(T.a)(F,Y,(function(e){return{text:ee(e)}})),Object(T.a)(F,_,(function(e){return{nodeName:e.nodeName,attributes:$(e),children:ee(e)}})),Object(T.a)(F,P,(function(e){return{children:ee(e)}})),Object(T.a)(F,H,(function(e){return{xmlText:ee(e)}})),Object(T.a)(F,J,(function(e){return{client:e.id.client,clock:e.id.clock,length:e.length}})),Object(T.a)(F,L,(function(e){return Object(l.a)(Object(l.a)({client:e.id.client,clock:e.id.clock},function(e){return(4&e.info)>0?{deleted:!0}:{}}(e)),{},{content:ne(e.content)})})),Object(T.a)(F,G,(function(e){return{value:e.arr}})),Object(T.a)(F,W,(function(e){return{binary:e.content}})),Object(T.a)(F,X,(function(e){return{length:e.len}})),Object(T.a)(F,z,(function(e){return{doc:e.doc}})),Object(T.a)(F,K,(function(e){return{embed:e.embed}})),Object(T.a)(F,q,(function(e){return{key:e.key,value:e.value}})),Object(T.a)(F,Q,(function(e){return{json:e.arr}})),Object(T.a)(F,V,(function(e){return{string:e.str}})),Object(T.a)(F,Z,(function(e){return{value:ne(e.type)}})),F);function ne(e){var t=e.constructor.name,n=te[t];if(!n)return{type:t,error:"Unexpected type ".concat(t)};var c=n(e);return console.assert(void 0===c.type,"should not include type"),Object(l.a)({type:t},c)}n(42);var ce,re=(ce={},Object(T.a)(ce,V,(function(e){return Object(m.jsx)("div",{className:"string",children:e.string})})),Object(T.a)(ce,X,(function(e){return Object(m.jsx)("div",{className:"length",children:e.length})})),Object(T.a)(ce,Z,(function(e){return Object(m.jsx)("div",{className:"content-type",children:e.value.type})})),Object(T.a)(ce,G,(function(e){return Object(m.jsx)("div",{className:"content-any",children:e.value})})),Object(T.a)(ce,W,(function(){return Object(m.jsx)("div",{className:"content-binary",children:"Binary"})})),ce);function ae(e){return Object(m.jsxs)("div",{children:["Unsupported content type: ",e.type]})}function oe(e){var t,n=e.struct,c=n.content,r=n.deleted,a=n.client,o=n.clock;return Object(m.jsxs)("div",{className:"struct ".concat(c.type," ").concat(r||c.type===X?"deleted":""," ").concat(e.isFocusedClientId(a)?"focused":""),children:[Object(m.jsxs)("div",{className:"client",children:["Doc",null===(t=e.getDocByClientId(a))||void 0===t?void 0:t.id]}),Object(m.jsx)("div",{className:"clock",children:o}),(re[c.type]||ae)(c)]})}n(43);function se(e){return Object(m.jsx)("span",{className:"collapse ".concat(e.collapsed?"collapsed":""),onClick:e.onClick})}function ie(e){return Object(m.jsxs)("span",{className:"value string",children:['"',e.string,'"']})}function ue(e){return Object(m.jsx)("span",{className:"value number",children:e.number})}function le(e){return Object(m.jsx)("span",{className:"value boolean",children:e.boolean})}function de(e){return Object(m.jsx)("span",{className:"value null",children:e.value})}function je(e){var t=Object(c.useState)(!0),n=Object(j.a)(t,2),r=n[0],a=n[1];var o=Object.keys(e.object);return Object(m.jsxs)("span",{className:"value object",children:[Object(m.jsxs)("span",{className:"object-description",children:[Object(m.jsx)(se,{collapsed:r,onClick:function(){a(!r)}}),Object(m.jsx)("span",{className:"description",children:"Object()"})]}),!r&&o.map((function(t){return Object(m.jsxs)("div",{className:"object-item",children:[Object(m.jsx)("span",{className:"object-key",children:t}),Object(m.jsx)("span",{children:":"}),Object(m.jsx)("span",{className:"object-value",children:Object(m.jsx)(fe,{value:e.object[t]})})]},t)}))]})}function pe(e){var t=Object(c.useState)(!0),n=Object(j.a)(t,2),r=n[0],a=n[1];return Object(m.jsxs)("div",{className:"value array",children:[Object(m.jsxs)("div",{className:"array-description",children:[Object(m.jsx)(se,{collapsed:r,onClick:function(){a(!r)}}),Object(m.jsx)("span",{children:"Array(".concat(e.array.length,")")})]}),!r&&e.array.map((function(t,n){return Object(m.jsxs)("div",{className:"array-item",children:[Object(m.jsx)("span",{className:"array-key",children:n}),Object(m.jsx)("span",{children:":"}),Object(m.jsx)("span",{className:"array-value",children:Object(m.jsx)(fe,{value:e.array[n]})})]},n)}))]})}function fe(e){return"string"===typeof e.value?Object(m.jsx)(ie,{string:e.value}):"number"===typeof e.value?Object(m.jsx)(ue,{number:e.value}):"boolean"===typeof e.value?Object(m.jsx)(le,{boolean:e.value}):null===e.value||void 0===e.value?Object(m.jsx)(de,{value:e.value}):Array.isArray(e.value)?Object(m.jsx)(pe,{array:e.value}):Object(m.jsx)(je,{object:e.value})}n(44);function be(e){var t=ne(e.value);return t.type===Y?Object(m.jsxs)("div",{className:"abstract-type",children:[Object(m.jsxs)("div",{className:"abstract-type-name",children:[e.name,":"]}),Object(m.jsx)("div",{className:"abstract-type-value",children:t.text.map((function(t){return Object(m.jsx)(oe,{struct:t,isFocusedClientId:e.isFocusedClientId,getDocByClientId:e.getDocByClientId},"".concat(t.client,"-").concat(t.clock))}))})]}):Object(m.jsx)(fe,{value:t})}function he(e){var t=Array.from(e.yDoc.share.keys());return Object(m.jsx)("div",{className:"data-source-share",children:t.map((function(t){return Object(m.jsx)(be,{name:t,value:e.yDoc.share.get(t),getDocByClientId:e.getDocByClientId,isFocusedClientId:e.isFocusedClientId},t)}))})}n(45);function Oe(e){return Array.from(e.missing.keys()).map((function(t){return Object(m.jsxs)("p",{children:[Object(m.jsxs)("span",{className:"client-id",children:[t,":"]}),Object(m.jsx)("span",{children:e.missing.get(t)})]},t)}))}function ye(e){return Array.from(e.clients.keys()).map((function(t){return Object(m.jsxs)("div",{className:"client-container",children:[Object(m.jsxs)("div",{className:"client-id",children:["clientID: ",t]}),Object(m.jsx)("div",{className:"client-structs",children:e.clients.get(t).map((function(t){var n=ne(t);return Object(m.jsx)(oe,{struct:n,isFocusedClientId:e.isFocusedClientId,getDocByClientId:e.getDocByClientId},"".concat(n.client,"-").concat(n.clock))}))})]},t)}))}function xe(e){return Object(m.jsxs)("div",{className:"data-source-store",children:[e.yDoc.store.pendingStructs&&Object(m.jsxs)("div",{className:"pending-structs",children:[Object(m.jsx)("p",{children:"Missing:"}),Object(m.jsx)(Oe,{missing:e.yDoc.store.pendingStructs.missing})]}),Object(m.jsx)(ye,{clients:e.yDoc.store.clients,isFocusedClientId:e.isFocusedClientId,getDocByClientId:e.getDocByClientId})]})}n(46);function ve(e){return Object(m.jsx)("div",{className:"y-doc-model",children:e.dataSource===B.SHARE?Object(m.jsx)(he,{yDoc:e.yDoc,getDocByClientId:e.getDocByClientId,isFocusedClientId:e.isFocusedClientId}):Object(m.jsx)(xe,{yDoc:e.yDoc,getDocByClientId:e.getDocByClientId,isFocusedClientId:e.isFocusedClientId})})}n(47);function me(e){function t(t){var n=e.getDocByClientId(t);return(null===n||void 0===n?void 0:n.id)===e.focusedDocId}return Object(m.jsxs)("div",{className:"doc-container",onClick:e.onFocus,children:[Object(m.jsx)(D,{doc:e.doc,onCloseDoc:e.onCloseDoc,editable:e.editable}),Object(m.jsx)(I,{doc:e.doc,onEditorChange:e.onEditorChange,editable:e.editable,focused:t(e.doc.yDoc.clientID)}),Object(m.jsx)(E,{doc:e.doc,docs:e.docs,onSync:e.onSync,editable:e.editable}),Object(m.jsx)(ve,{yDoc:e.doc.yDoc,dataSource:e.dataSource,getDocByClientId:e.getDocByClientId,isFocusedClientId:t})]})}function ge(e){return Object(m.jsxs)("span",{className:"buttons-container",children:[Object(m.jsx)("span",{children:"Actions: "}),Object(m.jsx)("button",{onClick:function(){e.onOpenDoc()},children:"Open a new doc"})]})}n(48);var Ce="option-gc",De="option-pud";function ke(e){return e.target.value}function Se(e){function t(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ke;return function(c){e.onOptionChange(Object(T.a)({},t,n(c)))}}return Object(m.jsxs)("span",{className:"options-container",children:[Object(m.jsx)("label",{htmlFor:Ce,children:"GC:"}),Object(m.jsx)("input",{id:Ce,type:"checkbox",checked:e.options.gc,onChange:t("gc",(function(e){return e.target.checked}))}),Object(m.jsx)("label",{htmlFor:De,children:"PermanentUserData:"}),Object(m.jsx)("input",{id:De,type:"checkbox",checked:e.options.pud,onChange:t("pud",(function(e){return e.target.checked}))})]})}function Ne(e){return Object(m.jsxs)("div",{className:"actions-container",children:[Object(m.jsx)(ge,{onOpenDoc:e.onOpenDoc}),Object(m.jsx)(Se,{options:e.options,onOptionChange:e.onOptionChange})]})}var Ie={DocEdit:[[b],[h,{id:0,actions:[{type:x,pos:0,str:"FOO"}]}],[h,{id:0,actions:[{type:v,pos:1,len:1}]}],[h,{id:0,actions:[{type:x,pos:1,str:"T"}]}],[h,{id:0,actions:[{type:x,pos:1,str:"B"}]}]],TwoDocsSyncWithoutConflicts:[[b],[b],[h,{id:0,actions:[{type:x,pos:0,str:"FOO"}]}],[O,{from:0,to:1}],[h,{id:1,actions:[{type:v,pos:1,len:1}]}],[h,{id:1,actions:[{type:x,pos:1,str:"T"}]}],[O,{from:1,to:0}]],TwoDocsSyncWithConflicts:[[b],[b],[h,{id:0,actions:[{type:x,pos:0,str:"FOO"}]}],[O,{from:0,to:1}],[h,{id:0,actions:[{type:x,pos:3,str:"B"}]}],[h,{id:1,actions:[{type:x,pos:3,str:"T"}]}],[O,{from:1,to:0}],[O,{from:0,to:1}]],TwoDocsSyncWithLostUpdates:[[b],[b],[h,{id:0,actions:[{type:x,pos:0,str:"FOO"}]}],[O,{from:0,to:1}],[h,{id:0,actions:[{type:x,pos:3,str:"B"}]}],[h,{id:0,actions:[{type:x,pos:4,str:"AR"}]}],[h,{id:1,actions:[{type:x,pos:3,str:"T"}]}],[O,{from:0,to:1,index:1}],[O,{from:1,to:0}],[O,{from:0,to:1,index:0}]]};function we(e){return new Promise((function(t){setTimeout(t,e)}))}var Ee=n(3),Fe=n(1),Be=n(4),Te=n(12),Ae=[function(){return new p.a},function(){return new p.c},function(){return new p.e},function(e){Fe.k(e)},function(e){},function(e){Fe.k(e)},function(e){}];var Re=[function(){throw Te.c()},function(e){return{type:"deleted",length:Fe.l(e)}},function(e){for(var t=Fe.l(e),n=[],c=0;c<t;c++){var r=Fe.k(e);"undefined"===r?n.push(void 0):n.push(JSON.parse(r))}return{type:"json",content:n,length:t}},function(e){return{type:"binary",content:Fe.m(e),length:1}},function(e){var t=Fe.k(e);return{type:"string",string:t,length:t.length}},function(e){return{type:"embed",content:Fe.k(e),length:1}},function(e){return{type:"format",content:{key:Fe.k(e),value:Fe.k(e)},length:1}},function(e){return{type:"type",content:Ae[Fe.l(e)](e),length:1}},function(e){for(var t=Fe.l(e),n=[],c=0;c<t;c++){var r=Fe.h(e);n.push(r)}return{type:"any",content:n,length:t}}];function Ue(e){e instanceof Fe.a||(e=Fe.f(e));for(var t={clients:{}},n=Fe.l(e),c=0;c<n;c++){var r=Fe.l(e),a=Fe.l(e);if(a>0){t.clients[r]=[];for(var o=0;o<a;o++)t.clients[r].push({clock:Fe.l(e),length:Fe.l(e)})}}return t}function Me(e){var t=Fe.f(e);return{clientsStructs:function(e){for(var t={},n=Fe.l(e),c=0;c<n;c++){for(var r=Fe.l(e),a=[],o=Ye(e),s=o.clock,i=o.client,u=0;u<r;u++){var l=Fe.i(e),d=void 0;d=0!==(Be.i&l)?Pe(i,s,e,l):new _e(i,s,{length:Fe.l(e)}),a.push(d),s+=d.length}t[i]=a}return t}(t),deleteSet:Ue(t)}}function Ye(e){return{client:Fe.l(e),clock:Fe.l(e)}}var _e=function e(t,n,c,r,a,o,s,i,u){var l=this;Object(Ee.a)(this,e),this.client=t,this.clock=n,this.left=r,this.origin=a,this.right=o,this.rightOrigin=s,this.parentYKey=i,this.parent=u,Object.keys(c).forEach((function(e){l[e]=c[e]}))};function Pe(e,t,n,c){var r=(c&Be.g)===Be.g?Ye(n):null,a=(c&Be.f)===Be.f?Ye(n):null,o=0===(c&(Be.f|Be.g)),s=!!o&&1===Fe.l(n),i=o&&s?Fe.k(n):null,u=null;o&&!s&&(u=Ye(n)),o&&(c&Be.e)===Be.e&&Fe.k(n);var l=function(e,t){return Re[t&Be.i](e)}(n,c);return new _e(e,t,l,null,r,null,a,i,u)}function He(e){function t(t){e.onOptionChange({dataSource:t.target.value})}return Object(m.jsxs)("div",{className:"view-options-container",children:[Object(m.jsx)("label",{children:"Data source:"}),[{id:B.SHARE,label:"Share"},{id:B.STORE,label:"Store"}].map((function(n){return Object(m.jsxs)("span",{children:[Object(m.jsx)("input",{id:n.id,type:"radio",value:n.id,checked:e.options.dataSource===n.id,onChange:t}),Object(m.jsx)("label",{htmlFor:n.id,children:n.label})]},n.id)}))]})}n(55);function Je(){var e,t=Object(c.useState)((e="scenario",new URL(window.location.href).searchParams.get(e)||f)),n=Object(j.a)(t,2),r=n[0],a=n[1],o=Object(c.useState)(0),s=Object(j.a)(o,2),g=s[0],D=s[1],S=Object(c.useState)([]),N=Object(j.a)(S,2),I=N[0],w=N[1],E=Object(c.useState)({gc:!1,pud:!1}),F=Object(j.a)(E,2),T=F[0],A=F[1],R=Object(c.useState)({dataSource:B.SHARE}),U=Object(j.a)(R,2),M=U[0],Y=U[1],_=Object(c.useState)(null),P=Object(j.a)(_,2),H=P[0],J=P[1];function L(e){w(e),window.docs=e}function G(e,t){return W.apply(this,arguments)}function W(){return(W=Object(d.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=[],e.t1=Object(u.a)(I.slice(0,t)),e.next=4,n(I[t]);case 4:e.t2=e.sent,e.t3=[e.t2],e.t4=Object(u.a)(I.slice(t+1)),L(e.t0.concat.call(e.t0,e.t1,e.t3,e.t4));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(){return(X=Object(d.a)(i.a.mark((function e(){var t,n,c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:D(g+1),t=Ie[r],n=Object(j.a)(t[g],2),c=n[0],a=n[1],e.t0=c,e.next=e.t0===b?6:e.t0===h?9:e.t0===O?12:e.t0===y?15:18;break;case 6:return e.next=8,z();case 8:return e.abrupt("break",19);case 9:return e.next=11,V(a);case 11:return e.abrupt("break",19);case 12:return e.next=14,$(a);case 14:return e.abrupt("break",19);case 15:return e.next=17,q(a);case 17:return e.abrupt("break",19);case 18:throw new Error("Unexpected action: "+c);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(){return K.apply(this,arguments)}function K(){return(K=Object(d.a)(i.a.mark((function e(){var t,n,c,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=new p.b).gc=T.gc,n=I.length,(c=I.filter(Boolean)).length&&n!==c[0].id&&p.f(t,p.g(c[0].yDoc)),r=null,!T.pud){e.next=11;break}return(r=new p.d(t)).setUserMapping(t,t.clientID,"Doc".concat(n)),e.next=11,we(0);case 11:a=p.g(t),c.forEach((function(e){p.f(e.yDoc,a)})),L([].concat(Object(u.a)(I),[{id:n,yDoc:t,pud:r,updates:[]}]));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){return Q.apply(this,arguments)}function Q(){return(Q=Object(d.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.yDoc.destroy(),e.next=3,G(t.id,(function(){return null}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(d.a)(i.a.mark((function e(t){var n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,c=t.actions,e.next=3,G(n,function(){var e=Object(d.a)(i.a.mark((function e(t){var r,a,o,s,d,j,f,b,h,O,y,m;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=p.h(t.yDoc),o=0;case 3:if(!(o<c.length)){e.next=26;break}s=c[o],d=s.type,j=s.pos,f=s.str,b=s.len,h=t.yDoc.getText(k),e.t0=d,e.next=e.t0===x?10:e.t0===v?12:14;break;case 10:return h.insert(j,f),e.abrupt("break",15);case 12:return h.delete(j,b),e.abrupt("break",15);case 14:throw new Error("Unexpected type");case 15:return e.next=17,we(0);case 17:O=p.g(t.yDoc,a),y=Me(O),(m={items:y.clientsStructs[t.yDoc.clientID]||[],deleteSet:y.deleteSet.clients[t.yDoc.clientID]||[]}).items.forEach((function(e){if("binary"===e.type){var t=Ue(e.content);Object.keys(t).length&&(e.decodedContent=t),e.content="[...]"}})),console.log("update",m),r.push({action:s,payload:O,syncedIds:[n]});case 23:o++,e.next=3;break;case 26:if(1!==I.length){e.next=28;break}return e.abrupt("return",t);case 28:return e.abrupt("return",Object(l.a)(Object(l.a)({},t),{},{updates:[].concat(Object(u.a)(t.updates),r)}));case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e){return ee.apply(this,arguments)}function ee(){return(ee=Object(d.a)(i.a.mark((function e(t){var n,c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.from,c=t.to,r=t.index,e.next=3,G(n,(function(e){if(e){var t=I[c],n=void 0===r?e.updates:[e.updates[r]];return n.forEach((function(e){p.f(t.yDoc,e.payload)})),Object(l.a)(Object(l.a)({},e),{},{updates:e.updates.map((function(e){return n.includes(e)?e.syncedIds.includes(c)?e:Object(l.a)(Object(l.a)({},e),{},{syncedIds:[].concat(Object(u.a)(e.syncedIds),[c])}):e})).filter((function(e){return e.syncedIds.length!==I.filter(Boolean).length}))})}}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){return I.find((function(t){return t.yDoc.clientID===e}))}function ne(e){return function(){J(e.id)}}var ce=r===f;return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)(C,{scenarios:Ie,currentScenario:r,currentScenarioStepIndex:g,onScenarioChange:function(e){a(e),D(0),L([])},onNextStep:function(){return X.apply(this,arguments)},onRestartStep:function(){D(0),L([])},onOpenDoc:z}),!Ie[r]&&Object(m.jsx)(Ne,{onOpenDoc:z,options:T,onOptionChange:function(e){A(Object(l.a)(Object(l.a)({},T),e))}}),Object(m.jsx)(He,{options:M,onOptionChange:function(e){Y(Object(l.a)(Object(l.a)({},M),e))}}),Object(m.jsx)("div",{className:"docs-container",children:I.filter(Boolean).map((function(e){return Object(m.jsx)(me,{doc:e,docs:I,editable:ce,dataSource:M.dataSource,onCloseDoc:q,onEditorChange:V,onSync:$,getDocByClientId:te,onFocus:ne(e),focusedDocId:H},e.id)}))})]})}o.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(Je,{})}),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.f5850021.chunk.js.map