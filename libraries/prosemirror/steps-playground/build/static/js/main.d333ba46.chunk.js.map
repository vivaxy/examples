{"version":3,"sources":["editor/index.js","Timeline/Timeline.js","Timeline/index.js","index.js"],"names":["view","initialState","$editor","$content","onSteps","console","assert","schema","Schema","nodes","addListNodes","basicSchema","spec","marks","EditorState","create","doc","DOMParser","fromSchema","parse","plugins","exampleSetup","EditorView","state","dispatchTransaction","tr","docChanged","steps","map","step","s","toJSON","stepType","slice","content","toString","openStart","openEnd","attrs","Object","keys","mark","attrKey","join","type","updateState","apply","StepType","className","StepPosition","from","to","StepOpen","StepSlice","StepStructure","structure","StepMark","stepRenderer","replace","key","replaceAround","addMark","removeMark","Timeline","i","$root","timeline","render","ReactDOM","_$root","editor","document","getElementById"],"mappings":"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","file":"static/js/main.d333ba46.chunk.js","sourcesContent":["/**\n * @since 2021-09-28\n * @author vivaxy\n */\nimport { schema as basicSchema } from 'prosemirror-schema-basic';\nimport { EditorState } from 'prosemirror-state';\nimport { EditorView } from 'prosemirror-view';\nimport { DOMParser, Schema, Slice } from 'prosemirror-model';\nimport { addListNodes } from 'prosemirror-schema-list';\nimport { exampleSetup } from 'prosemirror-example-setup';\n\nlet view = null;\nlet initialState = null;\n\nexport default {\n  init({ $editor, $content }, { onSteps }) {\n    console.assert(!view, 'Editor already initialized');\n    const schema = new Schema({\n      nodes: addListNodes(basicSchema.spec.nodes, 'paragraph block*', 'block'),\n      marks: basicSchema.spec.marks,\n    });\n\n    initialState = EditorState.create({\n      schema,\n      doc: DOMParser.fromSchema(schema).parse($content),\n      plugins: exampleSetup({ schema }),\n    });\n\n    view = new EditorView($editor, {\n      state: initialState,\n      dispatchTransaction(tr) {\n        if (tr.docChanged) {\n          onSteps(\n            tr.steps.map(function (step) {\n              const s = step.toJSON();\n              switch (s.stepType) {\n                case 'replace':\n                case 'replaceAround':\n                  return {\n                    ...s,\n                    slice: step.slice.content.toString(),\n                    openStart: step.slice.openStart,\n                    openEnd: step.slice.openEnd,\n                  };\n                case 'addMark':\n                case 'removeMark':\n                  const attrs = Object.keys(s.mark.attrs || {}).map(function(attrKey) {\n                    return `${attrKey}=\"${s.mark.attrs[attrKey]}\"`\n                  }).join(' ');\n                  return {\n                    ...s,\n                    mark: `<${s.mark.type}${attrs ? ' ' + attrs : ''}>`,\n                  };\n                default:\n                  console.assert(false, 'Unexpected');\n                  return null;\n              }\n            }),\n          );\n        }\n        view.updateState(view.state.apply(tr));\n      },\n    });\n  },\n\n  destroy() {\n    console.assert(view, 'Editor not initialized');\n    view.destroy();\n  },\n};\n","/**\n * @since 2021-09-28\n * @author vivaxy\n */\nimport React from 'react';\nimport './Timeline.css';\n\nfunction StepType(step) {\n  return <div className=\"step-type\">{step.stepType}</div>;\n}\n\nfunction StepPosition(step) {\n  return (\n    <div className=\"step-row\">\n      <span className=\"step-key\">Position</span>\n      <span className=\"step-value\">\n        {step.from}, {step.to}\n      </span>\n    </div>\n  );\n}\n\nfunction StepOpen(step) {\n  return (\n    <div className=\"step-row\">\n      <span className=\"step-key\">Open</span>\n      <span className=\"step-value\">\n        {step.openStart}, {step.openEnd}\n      </span>\n    </div>\n  );\n}\n\nfunction StepSlice(step) {\n  return <div className=\"step-slice\">{step.slice}</div>;\n}\n\nfunction StepStructure(step) {\n  return (\n    <div className=\"step-row\">\n      <span className=\"step-key\">Structure</span>\n      <span className=\"step-value\">{step.structure ? '✔︎' : '✗'}</span>\n    </div>\n  );\n}\n\nfunction StepMark(step) {\n  return <div className=\"step-mark\">{step.mark}</div>;\n}\n\nfunction ReplaceStep(step, key) {\n  return (\n    <div key={key} className=\"step\">\n      <StepType {...step} />\n      <StepPosition {...step} />\n      <StepOpen {...step} />\n      <StepStructure {...step} />\n      <StepSlice {...step} />\n    </div>\n  );\n}\n\nfunction ReplaceAroundStep(step, key) {\n  return (\n    <div key={key} className=\"step\">\n      <StepType {...step} />\n      <StepPosition {...step} />\n      <StepOpen {...step} />\n      <StepStructure {...step} />\n      <StepSlice {...step} />\n    </div>\n  );\n}\n\nfunction AddMarkStep(step, key) {\n  return (\n    <div key={key} className=\"step\">\n      <StepType {...step} />\n      <StepPosition {...step} />\n      <StepMark {...step} />\n    </div>\n  );\n}\n\nfunction RemoveMarkStep(step, key) {\n  return (\n    <div key={key} className=\"step\">\n      <StepType {...step} />\n      <StepPosition {...step} />\n      <StepMark {...step} />\n    </div>\n  );\n}\n\nconst stepRenderer = {\n  replace: ReplaceStep,\n  replaceAround: ReplaceAroundStep,\n  addMark: AddMarkStep,\n  removeMark: RemoveMarkStep,\n};\n\nexport default function Timeline({ steps }) {\n  return (\n    <div className=\"timeline\">\n      <p>Timeline:</p>\n      <div className=\"steps\">\n        {steps.map(function (step, i) {\n          return stepRenderer[step.stepType](step, i);\n        })}\n      </div>\n    </div>\n  );\n}\n","/**\n * @since 2021-09-28\n * @author vivaxy\n */\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport Timeline from './Timeline';\n\nlet $root = null;\n\nlet timeline = {\n  steps: [],\n};\n\nfunction render() {\n  ReactDOM.render(<Timeline {...timeline} />, $root);\n}\n\nexport default {\n  init({ $root: _$root }) {\n    $root = _$root;\n    console.assert($root, 'Invalid $root');\n    render();\n  },\n  appendSteps(steps) {\n    timeline = {\n      ...timeline,\n      steps: [...timeline.steps, ...steps],\n    };\n    render();\n  },\n  destroy() {\n    console.assert($root, 'Invalid $root');\n    ReactDOM.render(null, $root);\n  },\n};\n","import editor from './editor';\nimport timeline from './Timeline';\nimport './index.css';\n\neditor.init(\n  {\n    $editor: document.getElementById('editor'),\n    $content: document.getElementById('content'),\n  },\n  {\n    onSteps,\n  },\n);\ntimeline.init(\n  {\n    $root: document.getElementById('root'),\n  },\n);\n\nfunction onSteps(steps) {\n  timeline.appendSteps(steps);\n}\n"],"sourceRoot":""}